<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Post an Ad</title>
    <link rel="stylesheet" href="styles.css"> <!-- Link to your CSS file -->
</head>
<body>
    <header>
        <h1>Create New Listing</h1>
        <nav>
            <ul>
                <li><a href="index.html">Home</a></li>
                <li><a href="post_ad.html">New Listing</a></li>
		<li><a href="listings.html">View All Listings</a></li>
                <li><a href="login.html">Login</a></li>
                <li><a href="registration.html">Register</a></li>
                <li><a href="about.html">About</a></li>
            </ul>
        </nav>
    </header>

    <div class="post-ad">
        <h2>Post Your Ad</h2>
        <p> Please <a href="register.html">register</a> to create a new listing.</p>
        <form action="create_listing.php" method="POST"> <!-- Set action to PHP script -->
 	
            <label for="title">User Email:</label>
            <input type="text" id="user_email" name="user_email" required>

            <label for="category">Category:</label>
            <select id="category" name="category" required>
                <option value="">--Select Category--</option>
                <option value="Auto">Auto</option>
                <option value="Electronics">Electronics</option>
                <option value="Furniture">Furniture</option>
                <option value="Other">Other</option>
            </select>

            <label for="title">Ad Title:</label>
            <input type="text" id="title" name="title" required>

            <label for="description">Description:</label>
            <textarea id="description" name="description" rows="4" required></textarea>

           <!-- Price input field -->
           <label for="price">Price:</label>
           <input type="number" step="0.01" id="price" name="price" class="input-field" required>


            <label for="state">Select State:</label>
            <select id="state" name="state" onchange="updateCities()" required>
                <option value="">--Select State--</option>
                <option value="AL">Alabama</option>
                <option value="AK">Alaska</option>
                <option value="AZ">Arizona</option>
                <option value="AR">Arkansas</option>
                <option value="CA">California</option>
                <option value="CO">Colorado</option>
                <option value="CT">Connecticut</option>
                <option value="DE">Delaware</option>
                <option value="FL">Florida</option>
                <option value="GA">Georgia</option>
                <option value="HI">Hawaii</option>
                <option value="ID">Idaho</option>
                <option value="IL">Illinois</option>
                <option value="IN">Indiana</option>
                <option value="IA">Iowa</option>
                <option value="KS">Kansas</option>
                <option value="KY">Kentucky</option>
                <option value="LA">Louisiana</option>
                <option value="ME">Maine</option>
                <option value="MD">Maryland</option>
                <option value="MA">Massachusetts</option>
                <option value="MI">Michigan</option>
                <option value="MN">Minnesota</option>
                <option value="MS">Mississippi</option>
                <option value="MO">Missouri</option>
                <option value="MT">Montana</option>
                <option value="NE">Nebraska</option>
                <option value="NV">Nevada</option>
                <option value="NH">New Hampshire</option>
                <option value="NJ">New Jersey</option>
                <option value="NM">New Mexico</option>
                <option value="NY">New York</option>
                <option value="NC">North Carolina</option>
                <option value="ND">North Dakota</option>
                <option value="OH">Ohio</option>
                <option value="OK">Oklahoma</option>
                <option value="OR">Oregon</option>
                <option value="PA">Pennsylvania</option>
                <option value="RI">Rhode Island</option>
                <option value="SC">South Carolina</option>
                <option value="SD">South Dakota</option>
                <option value="TN">Tennessee</option>
                <option value="TX">Texas</option>
                <option value="UT">Utah</option>
                <option value="VT">Vermont</option>
                <option value="VA">Virginia</option>
                <option value="WA">Washington</option>
                <option value="WV">West Virginia</option>
                <option value="WI">Wisconsin</option>
                <option value="WY">Wyoming</option>
            </select>

            <label for="city">Select City:</label>
            <div>
                <select id="city-dropdown" name="city" onchange="toggleInput()" required>
                    <option value="">--Select City--</option>
                    <!-- Cities will be populated based on state selection -->
                </select>
                <input type="text" id="city-input" name="city-input" placeholder="Type your city here if it is not listed" oninput="clearDropdown()" />
            </div>

    <!-- File upload input -->
    <label for="images">Upload Images:</label>
    <input type="file" id="images" name="images[]" multiple>


            <button type="submit">Submit</button>
        </form>
    </div>

    <footer>
        <p>&copy; 2024 Craigslist 2.0 | All rights reserved </p>
        <div class="footer-links">
            <a href="index.html">Home</a>
            <a href="about.html">About</a>
        </div>
    </footer>

    <script>
        const citiesByState = {
            'AL': ['Birmingham', 'Montgomery', 'Huntsville', 'Mobile', 'Tuscaloosa'],
            'AK': ['Anchorage', 'Fairbanks', 'Juneau', 'Sitka', 'Ketchikan'],
            'AZ': ['Phoenix', 'Tucson', 'Mesa', 'Chandler', 'Scottsdale'],
            'AR': ['Little Rock', 'Fort Smith', 'Fayetteville', 'Springdale', 'Jonesboro'],
            'CA': ['Los Angeles', 'San Francisco', 'San Diego', 'San Jose', 'Sacramento'],
            'CO': ['Denver', 'Colorado Springs', 'Aurora', 'Fort Collins', 'Lakewood'],
            'CT': ['Hartford', 'New Haven', 'Stamford', 'Bridgeport', 'Waterbury'],
            'DE': ['Wilmington', 'Dover', 'Newark', 'Middletown', 'Smyrna'],
            'FL': ['Jacksonville', 'Miami', 'Tampa', 'Orlando', 'St. Petersburg'],
            'GA': ['Atlanta', 'Augusta', 'Columbus', 'Savannah', 'Athens'],
            'HI': ['Honolulu', 'Hilo', 'Kailua', 'Kaneohe', 'Lahaina'],
            'ID': ['Boise', 'Nampa', 'Idaho Falls', 'Pocatello', 'Meridian'],
            'IL': ['Chicago', 'Aurora', 'Naperville', 'Rockford', 'Joliet'],
            'IN': ['Indianapolis', 'Fort Wayne', 'Evansville', 'South Bend', 'Carmel'],
            'IA': ['Des Moines', 'Cedar Rapids', 'Davenport', 'Sioux City', 'Iowa City'],
            'KS': ['Wichita', 'Overland Park', 'Kansas City', 'Topeka', 'Olathe'],
            'KY': ['Louisville', 'Lexington', 'Bowling Green', 'Owensboro', 'Covington'],
            'LA': ['New Orleans', 'Baton Rouge', 'Shreveport', 'Lafayette', 'Lake Charles'],
            'ME': ['Portland', 'Lewiston', 'Bangor', 'South Portland', 'Auburn'],
            'MD': ['Baltimore', 'Frederick', 'Rockville', 'Gaithersburg', 'Bowie'],
            'MA': ['Boston', 'Worcester', 'Springfield', 'Lowell', 'Cambridge'],
            'MI': ['Detroit', 'Grand Rapids', 'Warren', 'Sterling Heights', 'Ann Arbor'],
            'MN': ['Minneapolis', 'Saint Paul', 'Rochester', 'Duluth', 'Bloomington'],
            'MS': ['Jackson', 'Gulfport', 'Southaven', 'Hattiesburg', 'Biloxi'],
            'MO': ['Kansas City', 'St. Louis', 'Springfield', 'Columbia', 'Lee\'s Summit'],
            'MT': ['Billings', 'Missoula', 'Great Falls', 'Bozeman', 'Helena'],
            'NE': ['Omaha', 'Lincoln', 'Bellevue', 'Grand Island', 'Kearney'],
            'NV': ['Las Vegas', 'Henderson', 'Reno', 'North Las Vegas', 'Sparks'],
            'NH': ['Manchester', 'Nashua', 'Concord', 'Derry', 'Rochester'],
            'NJ': ['Newark', 'Jersey City', 'Paterson', 'Elizabeth', 'Edison'],
            'NM': ['Albuquerque', 'Las Cruces', 'Rio Rancho', 'Santa Fe', 'Roswell'],
            'NY': ['New York City', 'Buffalo', 'Rochester', 'Yonkers', 'Syracuse'],
            'NC': ['Charlotte', 'Raleigh', 'Greensboro', 'Durham', 'Winston-Salem'],
            'ND': ['Fargo', 'Bismarck', 'Grand Forks', 'Minot', 'Dickinson'],
            'OH': ['Columbus', 'Cleveland', 'Cincinnati', 'Toledo', 'Akron'],
            'OK': ['Oklahoma City', 'Tulsa', 'Norman', 'Broken Arrow', 'Edmond'],
            'OR': ['Portland', 'Salem', 'Eugene', 'Gresham', 'Hillsboro'],
            'PA': ['Philadelphia', 'Pittsburgh', 'Allentown', 'Erie', 'Reading'],
            'RI': ['Providence', 'Warwick', 'Cranston', 'Pawtucket', 'East Providence'],
            'SC': ['Columbia', 'Charleston', 'North Charleston', 'Greenville', 'Summerville'],
            'SD': ['Sioux Falls', 'Rapid City', 'Aberdeen', 'Brookings', 'Mitchell'],
            'TN': ['Nashville', 'Memphis', 'Knoxville', 'Chattanooga', 'Clarksville'],
            'TX': ['Houston', 'San Antonio', 'Dallas', 'Austin', 'Fort Worth'],
            'UT': ['Salt Lake City', 'West Valley City', 'Provo', 'West Jordan', 'Orem'],
            'VT': ['Burlington', 'Essex', 'South Burlington', 'Rutland', 'Barre'],
            'VA': ['Virginia Beach', 'Norfolk', 'Chesapeake', 'Richmond', 'Newport News'],
            'WA': ['Seattle', 'Spokane', 'Tacoma', 'Vancouver', 'Bellevue'],
            'WV': ['Charleston', 'Huntington', 'Morgantown', 'Parkersburg', 'Wheeling'],
            'WI': ['Milwaukee', 'Madison', 'Green Bay', 'Kenosha', 'Racine'],
            'WY': ['Cheyenne', 'Casper', 'Laramie', 'Gillette', 'Rock Springs'],
        };

        function updateCities() {
            const stateSelect = document.getElementById('state');
            const cityDropdown = document.getElementById('city-dropdown');
            const cityInput = document.getElementById('city-input');
            const selectedState = stateSelect.value;

            // Clear current options in city dropdown
            cityDropdown.innerHTML = '<option value="">--Select City--</option>';
            cityInput.value = ""; // Clear the input field

            if (selectedState) {
                const cities = citiesByState[selectedState] || [];
                cities.forEach(city => {
                    const option = document.createElement('option');
                    option.value = city;
                    option.textContent = city;
                    cityDropdown.appendChild(option);
                });
            }
        }

        function toggleInput() {
            const cityDropdown = document.getElementById('city-dropdown');
            const cityInput = document.getElementById('city-input');

            // Show input field if dropdown is empty or if user starts typing
            if (cityDropdown.value === "") {
                cityInput.style.display = "block";
            } else {
                cityInput.style.display = "none";
            }
        }

        function clearDropdown() {
            const cityDropdown = document.getElementById('city-dropdown');
            // Clear the dropdown when user types in the input field
            cityDropdown.value = ""; 
            toggleInput(); // Call to toggle input visibility
        }

	
        // Your existing JavaScript for city dropdown...

        // Function to handle form submission
        document.getElementById('listing-form').onsubmit = function(event) {
            event.preventDefault(); // Prevent default form submission

            const formData = new FormData(this);
            fetch('create_listing.php', {
                method: 'POST',
                body: formData
            })
            .then(response => response.json())
            .then(data => {
                const messageDiv = document.getElementById('message');
                messageDiv.style.display = 'block';

                if (data.success) {
                    messageDiv.style.color = 'green';
                    messageDiv.textContent = 'Listing created successfully!';
                    this.reset(); // Clear the form
                } else {
                    messageDiv.style.color = 'red';
                    messageDiv.textContent = data.message || 'Failed to create listing.';
                }
            })
            .catch(error => {
                console.error('Error:', error);
                const messageDiv = document.getElementById('message');
                messageDiv.style.display = 'block';
                messageDiv.style.color = 'red';
                messageDiv.textContent = 'An error occurred while creating the listing.';
            });
        };
    </script>
</body>
</html>
    </script>
</body>
</html>
